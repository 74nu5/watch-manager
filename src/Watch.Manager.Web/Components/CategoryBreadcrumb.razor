@using Watch.Manager.Web.Services.Models
@using Microsoft.FluentUI.AspNetCore.Components
@using Microsoft.FluentUI.AspNetCore.Components.Icons.Regular

<div class="breadcrumb-container">
    @if (CategoryPath?.Any() == true)
    {
        <nav class="breadcrumb">
            <FluentIcon Value="@(new Size16.Home())" Class="home-icon" />
            @for (int i = 0; i < CategoryPath.Count; i++)
            {
                var category = CategoryPath[i];
                var isLast = i == CategoryPath.Count - 1;

                <FluentButton
                    Appearance="@(isLast ? Appearance.Accent : Appearance.Stealth)"
                    @onclick="() => OnCategorySelected.InvokeAsync(category)"
                    Class="@(isLast ? "breadcrumb-current" : "breadcrumb-item")">
                    @category.Name
                </FluentButton>

                @if (!isLast)
                {
                    <FluentIcon Value="@(new Size16.ChevronRight())" Class="breadcrumb-separator" />
                }
            }
        </nav>
    }
    else if (!string.IsNullOrEmpty(CurrentCategoryName))
    {
        <nav class="breadcrumb">
            <FluentIcon Value="@(new Size16.Home())" Class="home-icon" />
            <span class="breadcrumb-current-text">@CurrentCategoryName</span>
        </nav>
    }
</div>

<style>
    .breadcrumb-container {
        margin-bottom: 16px;
        padding: 12px 16px;
        background-color: var(--neutral-layer-2);
        border-radius: 8px;
        border: 1px solid var(--neutral-stroke-divider-rest);
    }

    .breadcrumb {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
    }

    .home-icon {
        color: var(--neutral-foreground-rest);
        margin-right: 4px;
    }

    .breadcrumb-item {
        font-size: 0.9em;
        padding: 4px 8px;
        min-height: 28px;
        border-radius: 4px;
        transition: all 0.2s ease;
    }

    .breadcrumb-item:hover {
        background-color: var(--neutral-layer-3);
    }

    .breadcrumb-current {
        font-size: 0.9em;
        font-weight: 600;
        padding: 4px 12px;
        min-height: 28px;
        border-radius: 4px;
    }

    .breadcrumb-current-text {
        font-weight: 600;
        color: var(--accent-foreground-rest);
        font-size: 0.9em;
    }

    .breadcrumb-separator {
        color: var(--neutral-foreground-rest);
        font-size: 0.8em;
        opacity: 0.6;
    }
</style>

@code {
    /// <summary>
    /// Le chemin de navigation des catégories.
    /// </summary>
    [Parameter] public List<CategoryModel>? CategoryPath { get; set; }

    /// <summary>
    /// Le nom de la catégorie actuelle (si pas de chemin complet).
    /// </summary>
    [Parameter] public string? CurrentCategoryName { get; set; }

    /// <summary>
    /// Callback déclenché lors de la sélection d'une catégorie dans le breadcrumb.
    /// </summary>
    [Parameter] public EventCallback<CategoryModel> OnCategorySelected { get; set; }
}
